% This scripts tests the computation of the acceleration of a point mass in 
% ToD frame due to tides.

au = 149597870.691;

% Standard gravitational parameters of the Moon, the Earth and the
% Earth-Moon barycenter.
mu_moon  = 1.09318924524284471369E-11;
mu_earth = 8.88769273403302327042E-10;

r_TOD = [
    -0.0008249708829962265491456130384051448345; ...
    -0.0019890836571332696711134069289528270019; ...
    -0.0010848082336385369423004121358644624706
];
a_TOD_exp = [
    0.0000000000000011125796383256731902525137; ...
    0.0000000000000024015826584459015971893442; ...
    0.0000000000000013322663631167226957583430
];
a_BCRS_exp = [
    0.0000000000000011255789306895792455045721; ...
    0.0000000000000023966731351917730522684677; ...
    0.0000000000000013301865783142322997775532
];

a_TOD = acc_tides(r_TOD, mu_earth, mu_moon);

rel_error_a_TOD = norm(a_TOD - a_TOD_exp) / norm(a_TOD_exp)