osv_sun_de118 = [
     0.0045144118714356678417898294242149859201;...
     0.0007228284115206590329169578090784398228;...
     0.0002465910049256799787750771280059325363;...
    -0.0000002836944634081316664200953653329762;...
     0.0000051811944086463273100311328900335894;...
     0.0000022306588340621261045044771559320296
];

osv_earth_de118 = [
     0.1082176318288926575306163613277021795511;...
    -0.9270869831537623673156645054405089467764;...
    -0.4020803162138248953993979739607311785221;...
     0.0168259758335644570015343646218752837740;...
     0.0015623196866031471147229225948649400380;...
     0.0006775367895532445746895056082337305270
];

osv_moon_de118 = [
     0.1073819286646967019471787807560758665204;...
    -0.9290724223114440460946639177564065903425;...
    -0.4031635849843115404489424236089689657092;...
     0.0174247279519817929727132366224395809695;...
     0.0013881659730759043740178082515512869577;...
     0.0005890595933095328640138887976718251593
];


phi1   =  0.0001000155009510827775484967383512469041;
phi    =  0.0060334301972966575267065536536392755806;
theta1 =  0.0000149039876740924137480445027525988166;
theta  =  0.3823930072367719423809262480062898248434;
psi1   = -0.0001194342707653266860701180007708899211;
psi    =  1.2812043655548916998299091574153862893581;

JT = 2440400.50;

JDEPOCH = 2440400.5;
PSLPI  = 27.32158222801637949485;
PSLPIA = 27.3215820789337158203125;
PSLPIB = 1.490826636745416323896386e-7;
b = JT - JDEPOCH;
f = floor(b / PSLPI);
a = b - f * PSLPIA;
b = a - f * PSLPIB;
PSLP1 = 2.29971502189818919e-1;
psi1 = psi1 + PSLP1;
psi = psi + PSLP1 * b;

lib_de118 = [phi; phi1; theta; theta1; psi; psi1];

OSV = [osv_sun_de118, osv_earth_de118, osv_moon_de118];

mu_sun   = 2.95912208285591102582E-4;
mu_earth = 8.88769273403302327042E-10;
mu_moon  = 1.09318924524284471369E-11;

MU = [mu_sun, mu_earth, mu_moon];

% Zonal harmonics J_2, J_3 and J_4 in Earth's potential.
Je = [1.08263e-3; -2.54e-6; -1.61e-6];

% Zonal harmonics J_2, J_3 and J_4 in Moon's potential.
Jm = [2.02150907893e-4; 1.21260448837e-5; -1.45383007072e-7];

% Tesseral harmonics in Moon's potential.
CSnm = [
    2, 2,  2.230351309e-5,    0.0;; ...
    3, 1,  3.07082741328e-5,  5.61066891941e-6; ...
    3, 2,  4.88840471683e-6,  1.68743052295e-6; ...
    3, 3,  1.43603108489e-6, -3.343544677e-7; ...
    4, 1, -7.17780149806e-6,  2.94743374914e-6; ...
    4, 2, -1.43951838385e-6, -2.8843721272e-6; ...
    4, 3, -8.54788154819e-8, -7.88967312839e-7; ...
    4, 4, -1.5490389313e-7,   5.6404155572e-8
];

[A, acc_moon] = acc_oblateness(OSV, MU, lib_de118, JT, Je, Jm, CSnm)